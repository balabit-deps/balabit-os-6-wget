From cbbeca2af4962a648a2373b35cf8e497e11d90fd Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Tim=20R=C3=BChsen?= <tim.ruehsen@gmx.de>
Date: Thu, 17 Dec 2015 17:41:32 +0100
Subject: [PATCH] Cleanup code

* src/iri.c (do_conversion): Code cleanup
---
 src/iri.c | 10 ++--------
 1 file changed, 2 insertions(+), 8 deletions(-)

Index: wget-1.17.1/src/iri.c
===================================================================
--- wget-1.17.1.orig/src/iri.c
+++ wget-1.17.1/src/iri.c
@@ -179,16 +179,10 @@ do_conversion (const char *tocode, const
         }
       else if (errno == E2BIG) /* Output buffer full */
         {
-          char *new;
-
           tooshort++;
           done = len;
-          outlen = done + inlen * 2;
-          new = xmalloc (outlen + 1);
-          memcpy (new, s, done);
-          xfree (s);
-          s = new;
-          len = outlen;
+          len = outlen = done + inlen * 2;
+          s = xrealloc (s, outlen + 1);
           *out = s + done;
         }
       else /* Weird, we got an unspecified error */
