commit 4d729e322fae359a1aefaafec1144764a54e8ad4
Author: Tim RÃ¼hsen <tim.ruehsen@gmx.de>
Date:   Mon Mar 6 10:04:22 2017 +0100

    Fix CRLF injection in Wget host part
    
    * src/url.c (url_parse): Reject control characters in host part of URL
    
    Reported-by: Orange Tsai

Index: wget-1.17.1/src/url.c
===================================================================
--- wget-1.17.1.orig/src/url.c	2017-10-23 15:35:45.106792502 -0400
+++ wget-1.17.1/src/url.c	2017-10-23 15:35:45.106792502 -0400
@@ -914,6 +914,17 @@ url_parse (const char *url, int *error,
       url_unescape (u->host);
       host_modified = true;
 
+      /* check for invalid control characters in host name */
+      for (p = u->host; *p; p++)
+        {
+          if (c_iscntrl(*p))
+            {
+              url_free(u);
+              error_code = PE_INVALID_HOST_NAME;
+              goto error;
+            }
+        }
+
       /* Apply IDNA regardless of iri->utf8_encode status */
       if (opt.enable_iri && iri)
         {
